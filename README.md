# Sales prediction


В цьому репозиторії наведено приклад невеличкого data science проекту для вирішення задачі передбачення цін товарів.


## Task


На підставі історичних даних з продажу товарів сформувати прогноз продажів на період 14 днів у розрізі товар/день. 

Представлено два датасети: **data/df.csv**, **data/df_future.csv**. 

У **df.csv** містяться всі історичні дані, на ньому передбачається зробити тренування, тюнінг і тестувати модель. У **df_future.csv** дані на майбутнє, future dataset. 

**df.csv** - продаж товарів у магазині по днях за останні 5 років.  Інформація представлена тільки за дні, коли були продажі:
- *date* - дата продажу;
- *sku_id* - код товару;
- *sales_quantity* - кількість проданих одиниць товару;
- *sales_price* - середня ціна продажу в день;
- *category_id* - код категорії товару.

Кінцевий прогноз зробити на підставі **df_future.csv** - необхідно спрогнозувати sales_quantity для товарів у зазначені дати (1/11/2020 - 14/11/2020):
- *date* - дата продажу;
- *sku_id* - код товару;
- *sales_price* - середня ціна продажу на день;
- *category_id* - код категорії товару.

Результатом завдання мають бути:
- jupyter ноутбук з аналізом даних (EDA), препроцесингом, тренуванням і валідацією, оцінкою точності та інших кроків, які кандидат вважатиме за потрібне включити;
- df_future.csv із заповненим прогнозом полем sales_quantity;
- git репозиторію, де видно покрокові комміти, сам код, організований у вигляді скриптів, функцій/класів, робота з гілками за необхідності, робота з файлами, що не трекаються, необхідні бібліотеки з версіями, і README.

Буде оцінюватися різнобічний аналіз даних (EDA), точність моделі, вміння писати чистий, зрозумілий код, робота з версіонуванням коду. Кандидат може використовувати будь-які типи моделей для тренування і метрики або комплекс метрик для оцінки точності моделі. Вибір метрики або їх комплексу необхідно обґрунтувати.


## Solution results

- Проведено базовий EDA з загальним аналізом датасету та детальним аналізом по групах і категоріях товарів.
- Виконано фіче-інженіринг з урахуванням різних LAG-фічей та SMA-фічей.
- Проведено кластерний аналіз та інтерпретовано отримані результати.
- Побудовано звичайні та realtime агрегації.
- Натреновано дві моделі на основі RandomForest та LGBM.
- Виконано підбір гіперпараметрів за допомогою Optuna.
- Проведено аналіз та валідацію результатів.
 Запропоновано можливі подальші покращення (детальніше дивіться у **notebooks/**).

P.S. Отримані метрики тренувань можна подивитись у **notebooks/predict.ipynb**.


## Usage

```
cd {project_directory}
poetry install --with dev
```

Ноутбуки з дослідженням та моделями доступні у **notebooks/**. 
Допоміжний код знаходиться у **src/**.